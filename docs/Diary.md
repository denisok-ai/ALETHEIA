# Дневник проекта AVATERRA

Подробный дневник наблюдений: технические решения, проблемы и их решения. Обеспечивает преемственность для разных разработчиков.

**Формат записи:**
- **Дата**
- **Наблюдения** — что заметили, какой контекст
- **Решения** — что решили и как
- **Проблемы** — что пошло не так, что открыто

---

## 2025-02-15 (продолжение: формы, валидация, защита от спама)

### Наблюдения
- Этап 3 в Tasktracker: форма обратной связи и форма записи в статусе «В процессе»; отправка уже подключена к /api/contact, кнопки ведут на #contact. Остались валидация/защита и документирование обработки заявок.

### Решения
- **Форма обратной связи и заявки:** отмечены как завершённые в Tasktracker. Кнопка «Записаться на курс» в секции Program переведена с #pricing на #contact — все заявки идут в одну форму.
- **Валидация:** на клиенте проверка телефона (не менее 10 цифр после удаления нецифровых символов); отображение сообщений об ошибках (errorMessage). На сервере в /api/contact добавлена проверка длины телефона и отклонение при неверном формате.
- **Защита от спама:** honeypot-поле «website» (скрытое, за экраном); если оно заполнено — отправка блокируется на клиенте и на сервере. Сервер возвращает 400 при заполненном honeypot.
- **Обработка заявок:** в Tasktracker отмечено «В процессе» — данные приходят в API; при настроенном Supabase пишутся в таблицу leads. Уведомления (email/мессенджеры) — отдельная задача этапа 4.

### Проблемы
- Нет.

---

## 2025-02-15 (миграция на Next.js 14 + PayKeeper + 3D по комплексному промпту)

### Наблюдения
- Клиенту не понравился предыдущий редизайн («всё стандартно»). Пользователь привёл комплексный промпт из другой модели: Next.js 14, Tailwind, Framer Motion, Three.js (частицы в Hero), shadcn/ui, PayKeeper, Supabase, Resend, деплой на Vercel. Референс дизайна — прототип Gamma; палитра: глубокие тёмные тона, золотые/бронзовые акценты (purple #2D1B4E, gold #D4AF37, dark #0A0E27).

### Решения
- **Стек:** Next.js 14 (App Router), TypeScript, Tailwind CSS, Framer Motion, React Three Fiber + drei для 3D-фона Hero (частицы), shadcn-подобные UI-компоненты (button, input, label, dialog). PayKeeper — lib/paykeeper.ts (createPayKeeperInvoice, validatePayKeeperWebhook). Supabase — опционально (createClient возвращает null при отсутствии env); таблицы orders, leads, course_access — по промпту.
- **Структура:** app/layout.tsx, app/page.tsx (лендинг), app/success, app/oferta, app/privacy; app/api/payment/create, app/api/webhook/paykeeper, app/api/contact. Компоненты: sections (Header, Footer, Hero, About, Program, Author, Testimonials, Pricing, FAQ, Contact), ui (button, input, label, dialog), 3d/ParticleBackground (динамический импорт с ssr: false), PaymentModal.
- **Контент:** Сохранён контент школы AVATERRA из Content.md (Татьяна Стрельцова, форматы и цены, отзывы, контакты). Тарифы для PayKeeper: consult 5000 ₽, course 25000 ₽, online 3500 ₽.
- **Дизайн:** Тёмный фон #0A0E27, акцент #D4AF37, типографика Literata (заголовки) + Outfit (текст). Hero — полноэкран с 3D-частицами и фото Татьяны; reveal-анимации через Framer Motion (useInView). Карточки с hover и градиентами.
- **Устойчивость:** API payment/create и contact работают без Supabase (запись в БД пропускается); payment/create без PayKeeper возвращает 500 с сообщением. Старые файлы Vite (index.html, src/, vite.config.js) удалены.

### Проблемы
- Для реальных платежей необходимо настроить .env (PayKeeper, Supabase), создать таблицы orders/leads в Supabase и указать webhook URL в личном кабинете PayKeeper.

---

## 2025-02-15 (полный редизайн: тёмная тема, bento, новая типографика)

### Наблюдения
- Запрос пользователя: не нравится текущий дизайн; использовать современные технологии дизайна; переделать сайт полностью, сделать непохожим на стандартную структуру; тексты и картинки можно перегенерировать для вовлечения ЦА; запустить в режиме отладки и проверить дизайн.

### Решения
- **Структура:** Hero — split layout (фото справа, текст слева), заголовок «Тело знает ответ» вместо только «AVATERRA» для вовлечения. Секция «Почему AVATERRA» — bento-сетка (одна большая карточка, две маленькие, одна широкая). Форматы — сетка 2 колонки с выделенной карточкой «Курс AVATERRA» на всю ширину. О мастере, отзывы, контакты — без смены логики, но с новой визуальной подачей.
- **Палитра:** Тёмная тема: фон #0f0e0c, поверхности #242220, текст #f5f0e8, акцент терракотовый #c45c3e. Отход от светлой кремово-золотой схемы для более современного и запоминающегося вида.
- **Типографика:** Literata (заголовки), Outfit (текст). Кикеры (section__kicker) над заголовками, увеличенные заголовки секций.
- **Стили:** Градиенты и размытые shapes в Hero вместо фоновой картинки; поддержка prefers-reduced-motion; :focus-visible для доступности; плейсхолдер при отсутствии фото Татьяны (onerror + .has-fallback).
- **Тексты:** Подзаголовки и лиды слегка переформулированы для более живого тона («Тело знает ответ», «20+ лет мы помогаем людям обрести баланс», «Истории тех, кто прошёл путь»).
- **Запуск:** Dev-сервер Vite на http://localhost:5173/ (команда: `npm run dev` в корне проекта, в WSL: `wsl -e bash -c "cd /home/denisok/projects/AVATERRA && npm run dev"`).

### Проблемы
- Нет. Браузерная проверка через MCP недоступна в данной среде — пользователю рекомендуется открыть http://localhost:5173/ и проверить отображение самостоятельно.

---

## 2025-02-14 (новая концепция сайта с фото основательницы)

### Наблюдения
- Пользователь предоставил два реальных фото Татьяны Стрельцовой (основательницы школы) и запросил полную переделку сайта: новая структура, цели, современные тенденции, при необходимости перегенерация текста и картинок, новая концепция. Дизайн — с учётом прошлого промта (Frontend Design Skill: уникальный интерфейс, глубина, типографика, не generic AI).

### Решения
- **Концепция:** Основательница в центре (founder-led), короткие блоки, один главный CTA «Записаться». Структура: Hero с фото Татьяны → Почему AVATERRA → Форматы работы → О мастере (второе фото + история от первого лица) → Отзывы → Записаться (форма + контакты) → Футер. Убраны отдельные блоки «История», «Партнёры», «FAQ» — партнёры и цифры встроены в «Почему» и контакты.
- **Изображения:** Реальные фото сохранены в `public/images/tatiana/tatiana-hero.png` и `tatiana-about.png`. Сгенерированы новые фоны в светлой палитре: `hero-cream.jpg`, `section-cream.jpg` — кремовые, воздушные, в тон фотографий основательницы.
- **Дизайн:** Светлая элегантная тема: фон #fffefb, #faf8f5, #f5f2ec; акцент мягкое золото #a68b5b; шрифты Cormorant Garamond (заголовки), Outfit (текст). Тени, скругления, лёгкая зернистость; анимация появления при скролле (.reveal + Intersection Observer). Hero — двухколоночный layout: фото слева, текст справа (на мобиле — колонка, фото по центру).
- **Тексты:** Переписаны под новую структуру: сжатые формулировки, один призыв к действию на блок, блок «О мастере» от первого лица. Цены и форматы сохранены; отзывы слегка сокращены для читаемости.
- **Документация:** Обновлены Project.md (структура 2.0), Content.md (новый контент), Media.md (реальные фото + новые фоны).

### Проблемы
- Нет.

---

## 2025-02-14 (трёхмерный интерфейс по скиллу «дизайн интерфейса»)

### Наблюдения
- Запрос: сайт плоский и примитивный, картинки скучные — сделать трёхмерным, используя скилл по дизайну интерфейса (уникальные интерфейсы, глубина, анимация, пространственная композиция).

### Решения
- **Глубина и тени:** введены переменные --shadow-depth (3 слоя) и --shadow-depth-hover, --shadow-dramatic для карточек, изображений и блоков; у карточек и отзывов многослойные тени и усиленный hover.
- **Перспектива и 3D:** на секции history, services, why добавлена perspective; у service-card и why-card transform-style: preserve-3d, при hover — translateZ, rotateX для объёма; у history__step — лёгкий rotateX при наведении.
- **Hero:** диагональная полоса (.hero__diagonal) с градиентом для глубины; параллакс фона при скролле в main.js (лёгкое смещение и scale hero__bg-img).
- **Анимация при скролле:** класс .reveal с начальным opacity 0 и translateY(48px) scale(0.98); при появлении в зоне видимости (Intersection Observer) добавляется .is-visible с каскадной задержкой data-delay для поэтапного появления блоков.
- **Перекрытия и асимметрия:** отзывы с разным margin-top (nth-child) для лёгкого «ступенчатого» ряда; у второй карточки услуг небольшой сдвиг по вертикали; радиальные градиенты в services и contacts для атмосферы.
- **Мастер:** псевдоэлемент-ореол вокруг фото, при hover — лёгкий scale и усиленная тень у изображения.
- **Зерно:** усилена непрозрачность body::after для более выраженной текстуры.

### Проблемы
- Нет.

---

## 2025-02-14 (полный редизайн + сгенерированные изображения)

### Наблюдения
- Запрос: использовать новые скиллы в разработке дизайна, полностью переделать сайт школы, сгенерировать красивые картинки.
- Использован скилл frontend-design: bold aesthetic direction, типографика, цвет, движение, фоны и визуальные детали.

### Решения
- **Изображения:** сгенерированы 4 изображения и скопированы в `public/images/`: hero-avaterra.jpg (hero), section-harmony.jpg (история), master-portrait.jpg (блок мастера), reviews-bg.jpg (фон отзывов). Портрет мастера — плейсхолдер; при желании заменить на фото Татьяны с прототипа.
- **Эстетика:** «редакторская роскошь + органичная гармония» — доминанта глубокий лес (#1e3329), кремовый фон, золотой акцент (#b8860b). Шрифты: Fraunces (заголовки), Outfit (текст).
- **Hero:** полноэкранный фон (hero-avaterra.jpg), тёмный градиент-оверлей, кикер + крупный заголовок AVATERRA + подзаголовок, каскадная анимация появления (fadeUp).
- **Секции:** история — декоративная полоса с section-harmony.jpg; мастер — реальное фото из проекта (master-portrait.jpg); отзывы — фоновое изображение с светлым оверлеем. Зерно поверх body, тени и hover на карточках.
- **Хедер:** фиксированный, с backdrop-filter. Контент и стили переписаны в index.html и style.css.

### Проблемы
- Нет.

---

## 2025-02-14 (редизайн по Frontend Design Skill)

### Наблюдения
- Запрос на переделку дизайна с использованием скилла по фронтенд-дизайну (SkillsMP / Anthropic): выразительный, «продакшен» интерфейс без «generic AI» эстетики.

### Решения
- **Типографика:** вместо system-ui/Roboto подключены характерные шрифты: Cormorant Garamond (заголовки), Bricolage Grotesque (основной текст) — по рекомендациям скилла избегать Inter/Roboto/Arial.
- **Цвет и тема:** цельная палитра на CSS-переменных: доминанта — глубокий шалфей (2d4a3e), фон — тёплая бумага/беж (f5f0e8, ebe4d9), острый акцент — медно-янтарный (b85c38) для кнопок и ссылок.
- **Фон и глубина:** многослойные градиенты по секциям, лёгкая SVG-текстура (noise) поверх body для объёма; тени и бордеры для карточек.
- **Анимация:** осмысленное появление Hero (заголовок → подзаголовок → кнопка) с небольшим смещением и задержкой; лёгкий hover на кнопках и карточках (translateY, тень).
- **Детали:** разный radius (4px для кнопок/инпутов, 10–16px для карточек), фокус у полей формы на accent, липкий хедер с backdrop-filter.

### Проблемы
- Нет.

---

## 2025-02-14 (продолжение — вёрстка)

### Наблюдения
- Продолжение этапа 2: выбор стека и базовая вёрстка главной страницы.
- В системе не установлен Node.js/npm — сборка и dev-сервер потребуют установки Node для команд `npm install` и `npm run dev`.

### Решения
- **Стек:** Vite + vanilla HTML/CSS/JS. В корне: index.html, package.json, vite.config.js; стили и скрипты в src/ (style.css, main.js); медиа — в public/images/ (tatiana, partners, sections).
- **Лендинг:** одностраничный, все секции по Content.md: Hero, история (4 шага), услуги и цены (4 карточки), блок Татьяны Стрельцовой (плейсхолдер под фото), партнёры, отзывы, FAQ, «Почему AVATERRA», контакты с формой, футер. Шапка с якорными ссылками и бургер-меню для мобильных.
- **Стили:** по Media.md — спокойные тона (беж, мягкий зелёный, тёплый белый), переменные в :root, адаптивная сетка (grid, clamp), семантика и доступность (aria, label).
- **Форма:** разметка готова; в main.js — заглушка отправки (TODO: Formspree или свой API).
- **Изображения:** блок Татьяны — плейсхолдер; после сохранения фото с прототипа в public/images/tatiana/ заменить на тег img.

### Проблемы
- Без Node.js нельзя запустить `npm run dev` и `npm run build`. В README добавлена инструкция: установить Node.js, затем npm install && npm run dev.

---

## 2025-02-14 (позже)

### Наблюдения
- Заказчик подтвердил: все важные моменты отражены на прототипе; тексты и картинки с Татьяной Стрельцовой брать с сайта https://avaterra--6eat7ck.gamma.site/, остальные изображения переделать в сходном стиле.
- Контент прототипа получен (структура и тексты).

### Решения
- **Контент:** создан `docs/Content.md` со всеми текстами с прототипа по секциям (Hero, история, услуги и цены, Татьяна Стрельцова, партнёры, отзывы, FAQ, преимущества, контакты, футер). Использовать при вёрстке.
- **Медиа:** создан `docs/Media.md`. Фото Татьяны Стрельцовой — только с прототипа; остальные картинки — в едином стиле (спокойные, натуральные тона, тема здоровья и гармонии). Описана рекомендуемая структура папок и чек-лист.
- **Project.md:** обновлён до версии 1.1: добавлена реальная структура блоков по прототипу, ссылки на Content.md и Media.md.
- **Tasktracker.md:** отмечены как завершённые задачи «Согласовать контент и структуру по прототипу» и «Финальные тексты и медиа»; задачи по вёрстке сведены к главной странице (все секции) и решению «одна страница vs несколько».

### Проблемы
- Контактные данные в Content.md (телефон, email, адрес, сайт) взяты с прототипа; при необходимости заказчик должен прислать актуальные.
- Изображения с прототипа нужно вручную сохранить в проект (инструкция в Media.md).

---

## 2025-02-14

### Наблюдения
- Инициирован проект сайта школы AVATERRA. Цель — информационный сайт с фокусом на продажу курсов.
- Прототип на Gamma (https://avaterra--6eat7ck.gamma.site/) принят как референс; прямой доступ к нему при создании документации был недоступен.
- В корне проекта создана папка `docs/` и базовый набор документов: Project.md, Tasktracker.md, Diary.md, qa.md. Файл правил .cursorrules вынесен в корень проекта AVATERRA.

### Решения
- **Архитектура:** описан общий поток (клиент → фронтенд → формы/API → заявки/уведомления). Варианты реализации (статический сайт, SSG+CMS, full-stack) зафиксированы в Project.md; выбор отложен до ответов на qa.md.
- **Документация:** за основу взяты этапы из Project.md; Tasktracker разбит по этапам с приоритетами (Критический/Высокий/Средний/Низкий).
- **Правила:** перед операциями обращаться к `.cursorrules` в корне проекта.

### Проблемы
- Нет доступа к содержимому прототипа по ссылке (ошибка при загрузке). Рекомендуется вручную сверить структуру и контент прототипа с разделами в Project.md и Tasktracker.md.
- Остаются открытые вопросы в qa.md — их закрытие необходимо перед фиксацией стека и детализацией задач.

---

*Добавлять новые записи сверху (новая дата — новый блок с разделами Наблюдения / Решения / Проблемы).*
